<h1 class="page-title">Product Manager (Angular Signal)</h1>
@if (model(); as model) {
  <div class="form-container">
    <mat-card>
      <form #productForm="ngForm">
        <mat-form-field appearance="fill" class="form-field">
          <mat-label>Title</mat-label>
          <input #title="ngModel" matInput name="title" required [(ngModel)]="model.title" />
          @if (title.invalid && title.touched) {
            <mat-error>Title is required</mat-error>
          }
        </mat-form-field>

        <mat-form-field appearance="fill" class="form-field">
          <mat-label>Description</mat-label>
          <input
            #description="ngModel"
            matInput
            name="description"
            required
            [(ngModel)]="model.description"
          />
          @if (description.invalid && description.touched) {
            <mat-error>Description is required</mat-error>
          }
        </mat-form-field>

        <mat-form-field appearance="fill" class="form-field">
          <mat-label>Price</mat-label>
          <input
            #price="ngModel"
            matInput
            type="number"
            name="price"
            required
            min="0"
            [(ngModel)]="model.price"
          />
          @if (price.invalid && price.touched) {
            <mat-error>Price is required</mat-error>
          }
        </mat-form-field>

        <div class="button-group">
          <button
            type="button"
            mat-raised-button
            color="primary"
            [disabled]="!productForm.form.valid"
            (click)="save()"
          >
            Save
          </button>

          <button
            type="button"
            mat-raised-button
            color="accent"
            [disabled]="!productForm.form.valid"
            (click)="saveAsDraft()"
          >
            Save As Draft
          </button>
        </div>
      </form>
    </mat-card>
  </div>
}
<hr />

@if (products(); as products) {
  <div class="list-container">
    <div class="grid-wrapper">
      @for (p of products; track p.id) {
        <mat-card class="product-card">
          <div class="card-content">
            <div class="product-title">{{ p.title }} - â‚¹{{ p.price }}</div>
            <div class="product-actions">
              <button type="button" mat-stroked-button color="primary" (click)="edit(p)">
                Edit
              </button>
              <button type="button" mat-stroked-button color="warn" (click)="delete(p)">
                Delete
              </button>
              @if (!p.isValid) {
                <button type="button" mat-stroked-button color="accent" (click)="discardDraft(p)">
                  Discard Draft
                </button>
              }
            </div>
          </div>
        </mat-card>
      }
    </div>
  </div>
}
<!-- (click)="discardDraft(p)" -->
