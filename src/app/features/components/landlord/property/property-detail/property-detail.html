<div class="property-detail-container">
  <!-- Header Section -->
  <div class="header-section">
    <div class="header-content">
      <ng-button 
        buttonType="button" 
        type="icon" 
        icon="arrow_back" 
        class="back-button" 
        (buttonClick)="goBack()">
      </ng-button>
      <div class="header-info">
        <h1>{{ property?.title || 'Property Details' }}</h1>
        <div class="header-meta">
          <span class="property-id">ID: #{{ property?.id }}</span>
          <mat-chip [ngClass]="getStatusClass()">
            <ng-icon [name]="getStatusIcon()"></ng-icon>
            {{ property?.status }}
          </mat-chip>
        </div>
      </div>
      <div class="header-actions">
        <ng-button 
          buttonType="button" 
          type="icon" 
          icon="edit" 
          class="action-btn" 
          tooltip="Edit Property" 
          (buttonClick)="editProperty()">
        </ng-button>
        <ng-button 
          buttonType="button" 
          type="icon" 
          icon="share" 
          class="action-btn" 
          tooltip="Share Property" 
          (buttonClick)="shareProperty()">
        </ng-button>
        <ng-button 
          buttonType="button" 
          type="icon" 
          icon="more_vert" 
          [matMenuTriggerFor]="moreMenu" 
          class="action-btn" 
          tooltip="More Options">
        </ng-button>
      </div>
    </div>
  </div>

  <div class="content-grid">
    <!-- Property Images Section -->
    <ng-card class="images-card">
      <div class="image-gallery">
        <div class="main-image">
          <img [src]="selectedImage || defaultImage" alt="Property Image" />
          <div class="image-overlay">
            <ng-button 
              buttonType="button" 
              type="fab" 
              icon="photo_library" 
              class="gallery-btn" 
              (buttonClick)="openGallery()">
            </ng-button>
          </div>
        </div>
        <div class="thumbnail-strip" *ngIf="propertyImages.length > 1">
          <div class="thumbnail" 
               *ngFor="let image of propertyImages" 
               [class.active]="image === selectedImage"
               (click)="selectImage(image)">
            <img [src]="image" alt="Property thumbnail" />
          </div>
        </div>
      </div>
    </ng-card>

    <!-- Property Overview -->
    <ng-card 
      class="overview-card" 
      title="Property Overview" 
      icon="visibility">
        <div class="overview-grid">
          <div class="overview-item">
            <ng-icon name="home"></ng-icon>
            <div>
              <span class="label">Type</span>
              <span class="value">{{ property?.propertyType }}</span>
            </div>
          </div>
          <div class="overview-item">
            <ng-icon name="bed"></ng-icon>
            <div>
              <span class="label">Configuration</span>
              <span class="value">{{ property?.bhkConfiguration }}</span>
            </div>
          </div>
          <div class="overview-item">
            <ng-icon name="square_foot"></ng-icon>
            <div>
              <span class="label">Carpet Area</span>
              <span class="value">{{ property?.carpetAreaSqFt }} sq ft</span>
            </div>
          </div>
          <div class="overview-item">
            <ng-icon name="layers"></ng-icon>
            <div>
              <span class="label">Floor</span>
              <span class="value">{{ property?.floorNumber }} of {{ property?.totalFloors }}</span>
            </div>
          </div>
          <div class="overview-item">
            <ng-icon name="chair"></ng-icon>
            <div>
              <span class="label">Furnishing</span>
              <span class="value">{{ property?.furnishingType }}</span>
            </div>
          </div>
          <div class="overview-item">
            <ng-icon name="schedule"></ng-icon>
            <div>
              <span class="label">Available From</span>
              <span class="value">{{ formatDate(property?.availableFrom) }}</span>
            </div>
          </div>
        </div>

    </ng-card>

    <!-- Rent Details -->
    <ng-card 
      class="rent-card" 
      title="Rent Details" 
      icon="payments">
        <div class="rent-info">
          <div class="rent-main">
            <div class="rent-amount">
              <span class="currency">₹</span>
              <span class="amount">{{ formatCurrency(property?.monthlyRent) }}</span>
              <span class="period">/month</span>
            </div>
            <div class="negotiable" *ngIf="property?.isNegotiable">
              <mat-chip color="accent">Negotiable</mat-chip>
            </div>
          </div>
          <div class="rent-details">
            <div class="detail-item">
              <span class="label">Security Deposit</span>
              <span class="value">₹{{ formatCurrency(property?.securityDeposit) }}</span>
            </div>
            <div class="detail-item">
              <span class="label">Lease Type</span>
              <span class="value">{{ property?.leaseType }}</span>
            </div>
          </div>
        </div>

    </ng-card>

    <!-- Location Details -->
    <ng-card 
      class="location-card" 
      title="Location" 
      icon="place">
        <div class="location-info">
          <div class="address">
            <p class="address-line">{{ property?.addressLine1 }}</p>
            <p class="address-line" *ngIf="property?.addressLine2">{{ property?.addressLine2 }}</p>
            <p class="address-line">{{ property?.locality }}, {{ property?.city }}</p>
            <p class="address-line">{{ property?.state }} - {{ property?.pinCode }}</p>
          </div>
          <div class="landmark" *ngIf="property?.landmark">
            <ng-icon name="map"></ng-icon>
            <span>Near {{ property?.landmark }}</span>
          </div>
          <ng-button 
            buttonType="button" 
            type="outlined" 
            label="View on Map" 
            icon="location_on" 
            class="map-button" 
            (buttonClick)="showOnMap()">
          </ng-button>
        </div>

    </ng-card>

    <!-- Property Details -->
    <ng-card 
      class="details-card" 
      title="Property Details" 
      icon="info">
        <div class="details-grid">
          <div class="detail-group">
            <h4>Room Details</h4>
            <div class="detail-item">
              <span class="label">Bathrooms</span>
              <span class="value">{{ property?.numberOfBathrooms }}</span>
            </div>
            <div class="detail-item">
              <span class="label">Balconies</span>
              <span class="value">{{ property?.numberOfBalconies || 0 }}</span>
            </div>
          </div>
          
          <div class="detail-group">
            <h4>Area Details</h4>
            <div class="detail-item">
              <span class="label">Carpet Area</span>
              <span class="value">{{ property?.carpetAreaSqFt }} sq ft</span>
            </div>
            <div class="detail-item">
              <span class="label">Built-up Area</span>
              <span class="value">{{ property?.builtUpAreaSqFt }} sq ft</span>
            </div>
          </div>
        </div>

    </ng-card>

    <!-- Amenities -->
    <ng-card 
      class="amenities-card" 
      title="Amenities & Features" 
      icon="apartment">
        <div class="amenities-grid">
          <div class="amenity-item" [class.available]="property?.hasLift">
            <ng-icon name="elevator"></ng-icon>
            <span>Lift</span>
            <ng-icon class="status-icon" [name]="property?.hasLift ? 'check_circle' : 'cancel'"></ng-icon>
          </div>
          <div class="amenity-item" [class.available]="property?.hasParking">
            <ng-icon name="local_parking"></ng-icon>
            <span>Parking</span>
            <ng-icon class="status-icon" [name]="property?.hasParking ? 'check_circle' : 'cancel'"></ng-icon>
          </div>
          <div class="amenity-item" [class.available]="property?.hasPowerBackup">
            <ng-icon name="battery_charging_full"></ng-icon>
            <span>Power Backup</span>
            <ng-icon class="status-icon" [name]="property?.hasPowerBackup ? 'check_circle' : 'cancel'"></ng-icon>
          </div>
          <div class="amenity-item" [class.available]="property?.hasWaterSupply">
            <ng-icon name="water_drop"></ng-icon>
            <span>24/7 Water</span>
            <ng-icon class="status-icon" [name]="property?.hasWaterSupply ? 'check_circle' : 'cancel'"></ng-icon>
          </div>
          <div class="amenity-item" [class.available]="property?.hasGasPipeline">
            <ng-icon name="local_fire_department"></ng-icon>
            <span>Gas Pipeline</span>
            <ng-icon class="status-icon" [name]="property?.hasGasPipeline ? 'check_circle' : 'cancel'"></ng-icon>
          </div>
          <div class="amenity-item" [class.available]="property?.hasSecurity">
            <ng-icon name="security"></ng-icon>
            <span>Security</span>
            <ng-icon class="status-icon" [name]="property?.hasSecurity ? 'check_circle' : 'cancel'"></ng-icon>
          </div>
          <div class="amenity-item" [class.available]="property?.hasInternet">
            <ng-icon name="wifi"></ng-icon>
            <span>Internet Ready</span>
            <ng-icon class="status-icon" [name]="property?.hasInternet ? 'check_circle' : 'cancel'"></ng-icon>
          </div>
        </div>

    </ng-card>

    <!-- Description -->
    <ng-card 
      class="description-card" 
      title="Description" 
      icon="description" 
      *ngIf="property?.description">
        <p class="description-text">{{ property?.description }}</p>

    </ng-card>

    <!-- Contact & Actions -->
    <ng-card 
      class="contact-card" 
      title="Contact Owner" 
      icon="contact_phone">
        <div class="contact-actions">
          <ng-button 
            buttonType="button" 
            type="filled" 
            label="Call Owner" 
            icon="phone" 
            class="contact-btn primary">
          </ng-button>
          <ng-button 
            buttonType="button" 
            type="outlined" 
            label="Send Message" 
            icon="message" 
            class="contact-btn secondary">
          </ng-button>
          <ng-button 
            buttonType="button" 
            type="outlined" 
            label="Schedule Visit" 
            icon="schedule" 
            class="contact-btn secondary">
          </ng-button>
        </div>

    </ng-card>
  </div>
</div>

<!-- More Options Menu -->
<mat-menu #moreMenu="matMenu">
  <button mat-menu-item (click)="markAsFavorite()">
    <ng-icon name="favorite_border"></ng-icon>
    <span>Add to Favorites</span>
  </button>
  <button mat-menu-item (click)="reportProperty()">
    <ng-icon name="report"></ng-icon>
    <span>Report Property</span>
  </button>
  <button mat-menu-item (click)="downloadDetails()">
    <ng-icon name="download"></ng-icon>
    <span>Download Details</span>
  </button>
  <mat-divider></mat-divider>
  <button mat-menu-item (click)="deleteProperty()" class="danger-item">
    <ng-icon name="delete"></ng-icon>
    <span>Delete Property</span>
  </button>
</mat-menu>